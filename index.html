<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rising Star Classic | Partner Draft Tool</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <nav class="navbar">
                <div class="logo">
                    <img src="./img/RSC.jpg" alt="Rising Star Classic Logo">
                    <span class="logo-text">Rising Star Classic Draft Tool</span>
                </div>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <div class="container">
            <div class="section-title">
                <h2>Partner Selection Draft</h2>
            </div>

            <!-- Draft Process -->
            <div class="draft-container">
                <div class="draft-header">
                    <div class="current-drafter">Current Pick: <span id="current-picker">Minges</span></div>
                    <div>Round: <span id="current-round">1</span> of 18</div>
                </div>

                <div class="draft-progress">
                    <div class="progress-bar" id="progress-bar"></div>
                </div>

                <div class="draft-sections">
                    <!-- Left Side: Drafters -->
                    <div class="players-section">
                        <div class="section-header">
                            <h3>Players Making Picks</h3>
                            <div>18 Players</div>
                        </div>
                        <div class="players-list" id="players-list">
                            <!-- Players will be added here by JavaScript -->
                        </div>
                    </div>

                    <!-- Right Side: Pool -->
                    <div class="pool-section">
                        <div class="section-header">
                            <h3>Available Partners (Pool)</h3>
                            <div>Make selection below</div>
                        </div>
                        <div class="pool-list" id="pool-list">
                            <!-- Pool players will be added here by JavaScript -->
                        </div>
                    </div>
                </div>

                <div class="draft-controls">
                    <button class="btn btn-disabled" id="prev-btn" disabled>Previous Pick</button>
                    <button class="btn" id="next-btn" disabled>Confirm Selection</button>
                </div>
            </div>

            <!-- Results (hidden initially) -->
            <div class="results-container hidden" id="results-container">
                <div class="section-title">
                    <h2>Draft Results</h2>
                </div>

                <div class="pairings-list" id="pairings-list">
                    <!-- Pairings will be added here -->
                </div>

                <div>
                    <textarea class="pairings-text" id="pairings-text" readonly></textarea>
                </div>

                <div class="export-controls">
                    <button class="btn" id="copy-btn">Copy to Clipboard</button>
                    <button class="btn" id="restart-btn">Start New Draft</button>
                </div>
            </div>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Players data (from the player list in image)
            const players = [
                { id: 1, name: "Minges", partner: null },
                { id: 2, name: "Joe M", partner: null },
                { id: 3, name: "Joe W", partner: null },
                { id: 4, name: "Lane", partner: null },
                { id: 5, name: "Couch", partner: null },
                { id: 6, name: "Nolan", partner: null },
                { id: 7, name: "Meister", partner: null },
                { id: 8, name: "Merkle", partner: null },
                { id: 9, name: "Randy", partner: null },
                { id: 10, name: "Curry", partner: null },
                { id: 11, name: "Han", partner: null },
                { id: 12, name: "Squeek", partner: null },
                { id: 13, name: "Butters", partner: null },
                { id: 14, name: "Foxx", partner: null },
                { id: 15, name: "Seth", partner: null },
                { id: 16, name: "Dan", partner: null },
                { id: 17, name: "Jarrett", partner: null },
                { id: 18, name: "Chris", partner: null }
            ];

            // Pool players data (from "The Pool" in image)
            const poolPlayers = [
                { id: 19, name: "Jesse" },
                { id: 20, name: "Creelman" },
                { id: 21, name: "Colton" },
                { id: 22, name: "Tony" },
                { id: 23, name: "Houck" },
                { id: 24, name: "Jim" },
                { id: 25, name: "Ray" },
                { id: 26, name: "Miniard" },
                { id: 27, name: "Warman" },
                { id: 28, name: "Noonan" },
                { id: 29, name: "Brandon" },
                { id: 30, name: "Josh" },
                { id: 31, name: "Ben" },
                { id: 32, name: "Waldroff" },
                { id: 33, name: "Jack" },
                { id: 34, name: "Jeff" },
                { id: 35, name: "Trey" },
                { id: 36, name: "Jason" }
            ];

            // DOM elements
            const playersListEl = document.getElementById('players-list');
            const poolListEl = document.getElementById('pool-list');
            const currentPickerEl = document.getElementById('current-picker');
            const currentRoundEl = document.getElementById('current-round');
            const progressBarEl = document.getElementById('progress-bar');
            const nextBtn = document.getElementById('next-btn');
            const prevBtn = document.getElementById('prev-btn');
            const resultsContainer = document.getElementById('results-container');
            const pairingsList = document.getElementById('pairings-list');
            const pairingsText = document.getElementById('pairings-text');
            const copyBtn = document.getElementById('copy-btn');
            const restartBtn = document.getElementById('restart-btn');

            // Draft state
            let currentPickIndex = 0;
            let selectedPoolPlayerId = null;
            let draftComplete = false;
            let draftHistory = [];

            // Initialize the draft
            function initializeDraft() {
                renderPlayers();
                renderPoolPlayers();
                updateCurrentPicker();
                updateProgressBar();
            }

            // Render the players list
            function renderPlayers() {
                playersListEl.innerHTML = '';
                players.forEach(player => {
                    const isCurrentPicker = players[currentPickIndex].id === player.id;
                    const playerCard = document.createElement('div');
                    playerCard.className = `player-card ${isCurrentPicker ? 'selected' : ''}`;

                    playerCard.innerHTML = `
                        <div class="player-number">${player.id}</div>
                        <div class="player-name">${player.name}</div>
                        ${player.partner ? `<div class="player-partner">Partner: ${player.partner.name}</div>` : ''}
                    `;

                    playersListEl.appendChild(playerCard);
                });
            }

            // Render the pool players
            function renderPoolPlayers() {
                poolListEl.innerHTML = '';

                // Only show pool players that haven't been selected
                const availablePoolPlayers = poolPlayers.filter(player =>
                    !players.some(p => p.partner && p.partner.id === player.id)
                );

                availablePoolPlayers.forEach(player => {
                    const playerCard = document.createElement('div');
                    playerCard.className = `player-card pool-player ${selectedPoolPlayerId === player.id ? 'selected' : ''}`;
                    playerCard.dataset.id = player.id;

                    playerCard.innerHTML = `
                        <div class="player-number">${player.id}</div>
                        <div class="player-name">${player.name}</div>
                    `;

                    playerCard.addEventListener('click', () => {
                        selectPoolPlayer(player.id);
                    });

                    poolListEl.appendChild(playerCard);
                });
            }

            // Select a pool player
            function selectPoolPlayer(id) {
                selectedPoolPlayerId = id;
                renderPoolPlayers();
                nextBtn.disabled = false;
            }

            // Update the current picker display
            function updateCurrentPicker() {
                if (draftComplete) {
                    currentPickerEl.textContent = "Draft Complete";
                    currentRoundEl.textContent = "18";
                    return;
                }

                const currentPlayer = players[currentPickIndex];
                currentPickerEl.textContent = currentPlayer.name;
                currentRoundEl.textContent = currentPickIndex + 1;
            }

            // Update the progress bar
            function updateProgressBar() {
                const progress = ((currentPickIndex) / players.length) * 100;
                progressBarEl.style.width = `${progress}%`;
            }

            // Move to the next pick
            function nextPick() {
                if (selectedPoolPlayerId === null) return;

                const currentPlayer = players[currentPickIndex];
                const selectedPoolPlayer = poolPlayers.find(p => p.id === selectedPoolPlayerId);

                // Save to history for undo functionality
                draftHistory.push({
                    playerIndex: currentPickIndex,
                    playerId: currentPlayer.id,
                    poolPlayerId: selectedPoolPlayerId
                });

                // Assign the partner
                currentPlayer.partner = selectedPoolPlayer;

                // Move to next player
                currentPickIndex++;
                selectedPoolPlayerId = null;
                nextBtn.disabled = true;
                prevBtn.disabled = false;

                // Check if draft is complete
                if (currentPickIndex >= players.length) {
                    draftComplete = true;
                    showResults();
                } else {
                    renderPlayers();
                    renderPoolPlayers();
                    updateCurrentPicker();
                    updateProgressBar();
                }
            }

            // Go back to the previous pick
            function previousPick() {
                if (draftHistory.length === 0) return;

                // Get the last pick
                const lastPick = draftHistory.pop();

                // Undo the partner assignment
                const player = players.find(p => p.id === lastPick.playerId);
                player.partner = null;

                // Move back to the previous picker
                currentPickIndex = lastPick.playerIndex;
                selectedPoolPlayerId = null;

                if (draftHistory.length === 0) {
                    prevBtn.disabled = true;
                }

                if (draftComplete) {
                    draftComplete = false;
                    resultsContainer.classList.add('hidden');
                }

                renderPlayers();
                renderPoolPlayers();
                updateCurrentPicker();
                updateProgressBar();
                nextBtn.disabled = true;
            }

            // Show the results
            function showResults() {
                // Update header display
                updateCurrentPicker();
                updateProgressBar();

                // Generate pairings display
                pairingsList.innerHTML = '';
                let pairingsOutput = "2025 Rising Star Classic - Draft Results\n";
                pairingsOutput += "=======================================\n\n";

                players.forEach((player, index) => {
                    const pairingDiv = document.createElement('div');
                    const pairingText = `${player.id}. ${player.name} is paired with ${player.partner ? player.partner.name : 'NO PARTNER'}`;

                    pairingDiv.innerHTML = `
                        <span class="pairing-highlight">${player.id}. ${player.name}</span> is paired with
                        <span class="pairing-highlight">${player.partner ? player.partner.name : 'NO PARTNER'}</span>
                    `;

                    pairingsList.appendChild(pairingDiv);
                    pairingsOutput += pairingText + "\n";
                });

                // Set the text for export
                pairingsText.value = pairingsOutput;

                // Show the results container
                resultsContainer.classList.remove('hidden');
            }

            // Copy pairings to clipboard
            function copyToClipboard() {
                pairingsText.select();
                document.execCommand('copy');
                copyBtn.textContent = 'Copied!';

                setTimeout(() => {
                    copyBtn.textContent = 'Copy to Clipboard';
                }, 2000);
            }

            // Restart the draft
            function restartDraft() {
                // Reset all player partners
                players.forEach(player => {
                    player.partner = null;
                });

                // Reset draft state
                currentPickIndex = 0;
                selectedPoolPlayerId = null;
                draftComplete = false;
                draftHistory = [];

                // Hide results
                resultsContainer.classList.add('hidden');

                // Reset UI
                prevBtn.disabled = true;
                nextBtn.disabled = true;

                // Re-render
                renderPlayers();
                renderPoolPlayers();
                updateCurrentPicker();
                updateProgressBar();
            }

            // Event listeners
            nextBtn.addEventListener('click', nextPick);
            prevBtn.addEventListener('click', previousPick);
            copyBtn.addEventListener('click', copyToClipboard);
            restartBtn.addEventListener('click', restartDraft);

            // Initialize
            initializeDraft();
        });
    </script>
</body>
</html>